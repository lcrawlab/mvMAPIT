<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Illustrating mvMAPIT with Simulations • mvMAPIT</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Illustrating mvMAPIT with Simulations">
<meta property="og:description" content="mvMAPIT">
<meta property="og:image" content="https://lcrawlab.github.io/mvMAPIT/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mvMAPIT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/mvMAPIT.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/lcrawlab/mvMAPIT/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="mvMAPIT_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="mvMAPIT_files/kePrint-0.0.1/kePrint.js"></script><link href="mvMAPIT_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Illustrating mvMAPIT with Simulations</h1>
                        <h4 data-toc-skip class="author">Julian Stamp</h4>
            
            <h4 data-toc-skip class="date">2022-11-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/lcrawlab/mvMAPIT/blob/HEAD/vignettes/mvMAPIT.Rmd" class="external-link"><code>vignettes/mvMAPIT.Rmd</code></a></small>
      <div class="hidden name"><code>mvMAPIT.Rmd</code></div>

    </div>

    
    
<p><strong><em>NOTE:</em></strong> if you use mvMAPIT in published research, please cite:</p>
<ul>
<li>Crawford, L., Zeng, P., Mukherjee, S., &amp; Zhou, X. (2017). Detecting epistasis with the marginal epistasis test in genetic mapping studies of quantitative traits. PLoS genetics, 13(7), e1006869.</li>
<li>Stamp, J., DenAdel, A., Weinreich, D. &amp; Crawford, L. (2022). Multivariate MAPIT.</li>
<li>Stamp J, Crawford L (2022). mvMAPIT: Multivariate Genome Wide Marginal Epistasis Test. <a href="https://github.com/lcrawlab/mvMAPIT" class="external-link uri">https://github.com/lcrawlab/mvMAPIT</a>, <a href="https://lcrawlab.github.io/mvMAPIT/" class="uri">https://lcrawlab.github.io/mvMAPIT/</a>
</li>
</ul>
<div class="section level2">
<h2 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>Load necessary libraries. For the sake of getting started, <code>mvMAPIT</code> comes with a small set of simulated data. This data contains random genotype-like data and two simulated quantitative traits with epistatic interactions. To make use of this data, call the genotype data as <code>simulated_data$genotype</code>, and the simulated trait data as <code>simulated_data$trait</code>. The vignette traces the simulation and the possible analysis of this data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lcrawlab/mvMAPIT" class="external-link">mvMAPIT</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/slowkow/ggrepel" class="external-link">ggrepel</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p><strong><em>NOTE:</em></strong> This code assumes that the basic C++ functions are set up on the computer in use. The <code>Rcpp</code> packages rely on C++ libraries, e.g. <code>openblas</code>, <code>lapack</code>, <code>flibs</code>. Mac users please refer to the homebrew applications and install the <code>gcc</code> commands listed in the <code>README</code> file.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="simulating-data">Simulating Data<a class="anchor" aria-label="anchor" href="#simulating-data"></a>
</h2>
<p>Data are simulated sample genotypes with <span class="math inline">\(p\)</span> single nucleotide polymorphisms (SNPs) and <span class="math inline">\(n\)</span> samples togeter with some quantitative traits.</p>
<div class="section level3">
<h3 id="simulate-genotypes">Simulate Genotypes<a class="anchor" aria-label="anchor" href="#simulate-genotypes"></a>
</h3>
<p>Create a matrix that contains underdetermined genotype data of random minor allele counts encoded as 0, 1, and 2. We control the minor allele frequency <code>maf</code> to be greater than 0.05.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n_samples</span> <span class="op">&lt;-</span> <span class="fl">2938</span></span>
<span><span class="va">n_snp</span> <span class="op">&lt;-</span> <span class="fl">5747</span></span>
<span></span>
<span><span class="va">maf</span> <span class="op">&lt;-</span> <span class="fl">0.05</span> <span class="op">+</span> <span class="fl">0.45</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_snp</span><span class="op">)</span></span>
<span><span class="va">random_minor_allele_counts</span>   <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_samples</span> <span class="op">*</span> <span class="va">n_snp</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">maf</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_samples</span> <span class="op">*</span> <span class="va">n_snp</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">maf</span><span class="op">)</span></span>
<span><span class="va">genotype_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">random_minor_allele_counts</span>,</span>
<span>  nrow <span class="op">=</span> <span class="va">n_samples</span>,</span>
<span>  ncol <span class="op">=</span> <span class="va">n_snp</span>,</span>
<span>  byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sample_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_samples</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span>fmt <span class="op">=</span> <span class="st">"id%04d"</span><span class="op">)</span></span>
<span><span class="va">snp_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_snp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span>fmt <span class="op">=</span> <span class="st">"snp%04d"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">genotype_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">snp_names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">genotype_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">sample_names</span></span></code></pre></div>
<p>The entries in the genotype matrix are:</p>
<ul>
<li>
<span class="math inline">\(0\)</span> if the genotype is homozygous in the reference allele,</li>
<li>
<span class="math inline">\(1\)</span> if both, the reference allele and the alternative allele are present,</li>
<li>
<span class="math inline">\(2\)</span> if the genotype is homozygous in the alternative allele.</li>
</ul>
<p>An example genotype matrix could look like this:</p>
<table class="table">
<thead><tr class="header">
<th>Sample</th>
<th>SNP 1</th>
<th>SNP 2</th>
<th>…</th>
<th>SNP p</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>0</td>
<td>1</td>
<td>…</td>
<td>2</td>
</tr>
<tr class="even">
<td>2</td>
<td>1</td>
<td>0</td>
<td>…</td>
<td>0</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>1</td>
</tr>
<tr class="even">
<td>n</td>
<td>2</td>
<td>2</td>
<td>…</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="simulate-traits">Simulate Traits<a class="anchor" aria-label="anchor" href="#simulate-traits"></a>
</h3>
<p>The simulated traits will be based on the genotype data simulated in the previous step. The causal SNPs as well as their effect sizes will be drawn at random. For simulating traits, we need to control the following simulation parameters.</p>
<p>Simulation Parameters:</p>
<ol style="list-style-type: decimal">
<li>
<code>n</code>: number of samples</li>
<li>
<code>p</code>: number of SNPs or variants</li>
<li>
<code>d</code>: number of traits</li>
<li>
<code>PVE</code>: phenotypic variance explained/broad-sense heritability (<span class="math inline">\(H^2\)</span>)</li>
<li>
<code>rho</code>: portion of <span class="math inline">\(H^2\)</span> that is contributed by the marginal (additive) effects</li>
<li>Number of SNPs that are causing variation in the trait:
<ul>
<li>
<code>n_causal</code>: total number of SNPs with any effects on traits.</li>
<li>
<code>n_trait_specific</code>: number of epistatic SNPs that affect a single trait.</li>
<li>
<code>n_pleiotropic</code>: number of epistatic SNPs that affect all traits.</li>
<li>
<code>group_ratio_pleiotropic</code>: ratio by which to split the epistatic SNPs into groups, e.g. 1:1, 1:3.</li>
</ul>
</li>
<li>
<code>epistatic_correlation</code>: correlation between the epistatic effects.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seed</span> <span class="op">&lt;-</span> <span class="fl">67132</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">PVE</span> <span class="op">&lt;-</span> <span class="fl">0.6</span></span>
<span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span><span class="va">n_causal</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">n_trait_specific</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">n_pleiotropic</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">group_ratio_pleiotropic</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">epistatic_correlation</span> <span class="op">&lt;-</span> <span class="fl">0.9</span></span>
<span><span class="va">maf</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">simulated_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_traits.html">simulate_traits</a></span><span class="op">(</span></span>
<span>    <span class="va">genotype_data</span>,</span>
<span>    n_causal <span class="op">=</span> <span class="va">n_causal</span>,</span>
<span>    n_trait_specific <span class="op">=</span> <span class="va">n_trait_specific</span>,</span>
<span>    n_pleiotropic <span class="op">=</span> <span class="va">n_pleiotropic</span>,</span>
<span>    d <span class="op">=</span> <span class="va">d</span>,</span>
<span>    H2 <span class="op">=</span> <span class="va">PVE</span>,</span>
<span>    rho <span class="op">=</span> <span class="va">rho</span>,</span>
<span>    epistatic_correlation <span class="op">=</span> <span class="va">epistatic_correlation</span>,</span>
<span>    group_ratio_pleiotropic <span class="op">=</span> <span class="va">group_ratio_pleiotropic</span>,</span>
<span>    maf_threshold <span class="op">=</span> <span class="va">maf</span>,</span>
<span>    seed <span class="op">=</span> <span class="va">seed</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We randomly choose causal variants that are split into three groups:</p>
<ol style="list-style-type: decimal">
<li>set of additive SNPs without interactions,</li>
<li>group 1 of interaction SNPs, and</li>
<li>group 2 of interaction SNPs.</li>
</ol>
<p>In the simulations carried out in this study, SNPs interact between sets. SNPs in the first group interact with SNPs in the second group, but do not interact with variants in their own group, and vice versa. One may view the SNPs in the first set as the “hubs” in an interaction map. We are reminded that interaction (epistatic) effects are different from additive effects. The following image illustrates the simulation of interactions.</p>
<div class="figure">
<img src="simulate_traits.png" style="width:80.0%" alt=""><p class="caption">Trait simulations. From all SNPs, a random subset of causal SNPs is sampled and assigned to one of three groups. SNPs in one of the two epistatic groups interact with all SNPs in the other epistatic group to simulate pairwise interactions.</p>
</div>
<blockquote>
<p><strong>NOTE</strong>: All causal SNPs in both the second and third groups have additive effects and are involved in pairwise interactions, while causal SNPs in the first set only have additive effects.</p>
</blockquote>
<p>For more details look at the end of this vignette.</p>
</div>
</div>
<div class="section level2">
<h2 id="running-mvmapit">Running mvMAPIT<a class="anchor" aria-label="anchor" href="#running-mvmapit"></a>
</h2>
<blockquote>
<p><strong>NOTE:</strong> mvMAPIT takes the X matrix as <span class="math inline">\(p \times n\)</span>; <strong>not</strong> as <span class="math inline">\(n \times p\)</span>.</p>
</blockquote>
<p>The R routine <code>mvmapit</code> can be run in multiple modes. By default it runs in a hybrid mode, performing tests both wtih a normal Z-test as well as the Davies method. The resulting <code>p</code>-values can be combined using functions provided by <code>mvMAPIT</code>, e.g. <code><a href="../reference/fishers_combined.html">fishers_combined()</a></code>, that work on the <code>pvalues</code> tibble that <code>mvmapit</code> returns.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mvmapit_hybrid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvmapit.html">mvmapit</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">genotype</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">trait</span><span class="op">)</span>,</span>
<span>        test <span class="op">=</span> <span class="st">"hybrid"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fisher</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fishers_combined.html">fishers_combined</a></span><span class="op">(</span><span class="va">mvmapit_hybrid</span><span class="op">$</span><span class="va">pvalues</span><span class="op">)</span></span></code></pre></div>
<p>To visualize the genome wide <code>p</code>-values, we use a Manhattan plot.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">manhplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">fisher</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">fisher</span><span class="op">)</span>, y <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">thresh</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"grey40"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.75</span>, color <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html" class="external-link">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">p</span> <span class="op">&lt;</span> <span class="va">thresh</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, <span class="st">''</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">manhplot</span><span class="op">)</span></span></code></pre></div>
<p><img src="mvMAPIT_files/figure-html/manhattan_plots-1.png" width="672"></p>
<p>To control the type I error despite multiple testing, we recomment the conservative Bonferroni correction. The significant SNPs returned by the <code>mvMAPIT</code> analysis are shown in the output below.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">thresh</span> <span class="op">&lt;-</span> <span class="fl">0.05</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">fisher</span><span class="op">)</span></span>
<span><span class="va">significant_snps</span> <span class="op">&lt;-</span>  <span class="va">fisher</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p</span> <span class="op">&lt;</span> <span class="va">thresh</span><span class="op">)</span> <span class="co"># Call only marginally significant SNPs</span></span>
<span></span>
<span><span class="va">truth</span> <span class="op">&lt;-</span> <span class="va">simulated_data</span><span class="op">$</span><span class="va">epistatic</span><span class="op">$</span><span class="va">name</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">significant_snps</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="op">~</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="va">.</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>true_pos <span class="op">=</span> <span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">truth</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">.</span>, linesep <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html" class="external-link">kable_material</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"striped"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-material lightable-striped" style='font-family: "Source Sans Pro", helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:left;">
trait
</th>
<th style="text-align:left;">
p
</th>
<th style="text-align:left;">
true_pos
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
snp_00576
</td>
<td style="text-align:left;">
fisher
</td>
<td style="text-align:left;">
3.25e-06
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
snp_00762
</td>
<td style="text-align:left;">
fisher
</td>
<td style="text-align:left;">
3.81e-09
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
snp_00901
</td>
<td style="text-align:left;">
fisher
</td>
<td style="text-align:left;">
5.99e-06
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
snp_00917
</td>
<td style="text-align:left;">
fisher
</td>
<td style="text-align:left;">
2.16e-07
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
snp_01092
</td>
<td style="text-align:left;">
fisher
</td>
<td style="text-align:left;">
7.54e-07
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
snp_02219
</td>
<td style="text-align:left;">
fisher
</td>
<td style="text-align:left;">
4.07e-21
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
snp_02262
</td>
<td style="text-align:left;">
fisher
</td>
<td style="text-align:left;">
2.41e-06
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
snp_02280
</td>
<td style="text-align:left;">
fisher
</td>
<td style="text-align:left;">
2.5e-13
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
snp_02476
</td>
<td style="text-align:left;">
fisher
</td>
<td style="text-align:left;">
2.05e-31
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
snp_03737
</td>
<td style="text-align:left;">
fisher
</td>
<td style="text-align:left;">
6.96e-07
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
snp_05699
</td>
<td style="text-align:left;">
fisher
</td>
<td style="text-align:left;">
1.82e-06
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
</tbody>
</table>
<p>To compare this list to the full list of causal epistatic SNPs of the simulations, refer to the following list.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">truth</span><span class="op">)</span></span>
<span><span class="co">#  [1] "snp_00762" "snp_00917" "snp_01092" "snp_02167" "snp_02219" "snp_02280"</span></span>
<span><span class="co">#  [7] "snp_02476" "snp_03737" "snp_04312" "snp_04565"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="running-an-informed-exhaustive-search">Running an Informed Exhaustive Search<a class="anchor" aria-label="anchor" href="#running-an-informed-exhaustive-search"></a>
</h2>
<p>Now we may take only the significant SNPs according to their marginal epistatic effects and run a simple exhaustive search between them. The significant SNPs are significant after combining the results from the multivariate analysis using Fisher’s method and adjusting the significnat threshold via Bonferroni correction.</p>
<p>The search itself is a simple regression on the interaction terms between all significant interactions.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># exhaustive search for p-values</span></span>
<span><span class="va">pairs</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">significant_snps</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pairnames</span> <span class="op">&lt;-</span> <span class="fu">comboGeneral</span><span class="op">(</span><span class="va">significant_snps</span><span class="op">$</span><span class="va">id</span>, <span class="fl">2</span><span class="op">)</span> </span>
<span>  <span class="co"># Generate unique pairs of SNP names; </span></span>
<span>  <span class="co"># for length(names) = n, the result is a (n * (n-1)) x 2 matrix with one row corresponding to a pair</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pairnames</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">X</span><span class="op">[</span>, <span class="va">pairnames</span><span class="op">[</span><span class="va">k</span>, <span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">:</span><span class="va">X</span><span class="op">[</span>, <span class="va">pairnames</span><span class="op">[</span><span class="va">k</span>, <span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">p_value1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">]</span></span>
<span>    <span class="va">p_value2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">]</span></span>
<span>    <span class="va">tib</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>            x <span class="op">=</span> <span class="va">p_value1</span>,</span>
<span>            y <span class="op">=</span> <span class="va">p_value2</span>,</span>
<span>            u <span class="op">=</span> <span class="va">pairnames</span><span class="op">[</span><span class="va">k</span>, <span class="fl">1</span><span class="op">]</span>,</span>
<span>            v <span class="op">=</span> <span class="va">pairnames</span><span class="op">[</span><span class="va">k</span>, <span class="fl">2</span><span class="op">]</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">pairs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">pairs</span>, <span class="va">tib</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, <span class="st">"var1"</span>, <span class="st">"var2"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="visualize-exhaustive-search-results">Visualize Exhaustive Search Results<a class="anchor" aria-label="anchor" href="#visualize-exhaustive-search-results"></a>
</h3>
<p>We plot the <span class="math inline">\(-\mathrm{log}_{10}(p)\)</span> of the <code>p</code>-values for the regression coefficients as tile plot to highlight the identified interaction structure.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plotable</span> <span class="op">&lt;-</span> <span class="va">pairs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"p_"</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"trait"</span>,</span>
<span>    names_prefix <span class="op">=</span> <span class="st">"trait "</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"p"</span>,</span>
<span>    values_drop_na <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pplot <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="op">~</span> <span class="va">p</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plotable</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">var1</span>, y<span class="op">=</span><span class="va">var2</span>, fill<span class="op">=</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">pplot</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">trait</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tiles</span><span class="op">)</span></span></code></pre></div>
<p><img src="mvMAPIT_files/figure-html/trait1_plots_exhaustive-1.png" width="672"></p>
<p>Compare this to the true interaction structure.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">true_interactions</span> <span class="op">&lt;-</span> <span class="va">simulated_data</span><span class="op">$</span><span class="va">interactions</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>var1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="va">group1</span>, fmt <span class="op">=</span> <span class="st">"snp_%05d"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>var2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="va">group2</span>, fmt <span class="op">=</span> <span class="st">"snp_%05d"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">true_tiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">true_interactions</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">var1</span>, y<span class="op">=</span><span class="va">var2</span>, fill<span class="op">=</span><span class="va">effect_size</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">trait</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"blue"</span>, high <span class="op">=</span> <span class="st">"red"</span>, mid <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">true_tiles</span><span class="op">)</span></span></code></pre></div>
<p><img src="mvMAPIT_files/figure-html/simulated_interactions-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="appendix-details-on-simulating-pairwise-epistasis">Appendix: Details on Simulating Pairwise Epistasis<a class="anchor" aria-label="anchor" href="#appendix-details-on-simulating-pairwise-epistasis"></a>
</h2>
<p>The general simulation scheme for interactions follows the methods outlined in Crawford et al. (2017). For the data representing the null hypothesis of no epistasis present, 1000 SNPs without rare variants are sampled from the genotype data. The effect sizes of the causal SNPs then are sampled independently from a multivariate normal distribution according to equation .</p>
<p><span class="math display">\[\begin{equation}\label{eq:null_simulations_beta}
    \mathbf{b}_i \sim \mathcal{N}_{d}\left(0, \mathbf{U}\right)
\end{equation}\]</span></p>
<p>As parameter of the simulations, <span class="math inline">\(\mathbf{U}\)</span> describes the covariance between the additive effects of the causal SNPs on the <span class="math inline">\(d\)</span> different traits. The effects of all other SNPs are set to zero.</p>
<p>In order to simulate pleiotropy, the number of desired pleiotropic SNPs is sampled from the set of causal SNPs. These SNPs are then included in simulating interactions for every trait. Additionally, trait specific SNPs are sampled independently for each trait from the causal SNPs without the pleiotropic SNPs.</p>
<p>The interactions are modeled by selecting the number of desired SNPs that have non-zero pairwise interaction effects. These SNPs then are split into two groups. Each SNP from one group is simulated to interact with each SNP of the other group but not with any SNP within the same group that it was assigned to. This results in <span class="math inline">\(n_1 \cdot n_2\)</span> epistatic interactions, with <span class="math inline">\(n_i\)</span> the number of SNPs in group i. For all these interactions, random effects are sampled from the multivariate normal distribution given in .</p>
<p><span class="math display">\[\begin{equation}\label{eq:simulations_alpha}
    \mathbf{a}_i \sim \mathcal{N}_{d}\left(0, \mathbf{V}\right)
\end{equation}\]</span></p>
<p>Analogously, <span class="math inline">\(\mathbf{V}\)</span> is the covariance between the pariwise epistatic effects of the causal SNPs on the <span class="math inline">\(d\)</span> different traits. The portion of the variance <span class="math inline">\(\mathbf{E}\)</span> that is not due to heritable effects is simulated as multivariate normal with no correlation. The effects of the SNPs and interactions are collected in matrices <span class="math inline">\(\mathbf{A}\)</span> and <span class="math inline">\(\mathbf{B}\)</span>. The matrices <span class="math inline">\(\mathbf{X}\)</span> and <span class="math inline">\(\mathbf{W}\)</span> contain the genotype data of the causal SNPs and interactions. With these effects, the phenotypes then are simulated according to equation .</p>
<p><span class="math display">\[\begin{equation}\label{eq:simulation_mapit}
    \mathbf{Y} = \mathbf{X}\mathbf{B} + \mathbf{W}\mathbf{A} + \mathbf{E}
\end{equation}\]</span></p>
<p>For each trait independently, the variance components are scaled such that the variance can be partitioned according to equation .</p>
<p><span class="math display">\[\begin{align}\label{eq:simulation_var_comp}
    \mathbf{Y} &amp;= \mathbf{Y}_{X} + \mathbf{Y}_{W} + \mathbf{E} \\
    \mathrm{var}(\mathbf{Y}) &amp;= \mathrm{var}(\mathbf{Y}_{X}) +
                            \mathrm{var}(\mathbf{Y}_{W}) +
                            \mathrm{var}(\mathbf{E}) \\
                         &amp;= \rho \cdot H^2 + (1 - \rho) \cdot H^2 + (1 - H^2) \\
                         &amp;= 1
\end{align}\]</span></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Julian Stamp, Lorin Crawford.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
